---
import "../styles/global.css";
import Header from "../components/header.astro";
import Footer from "../components/footer.astro";
---
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Weight converter</title>
	</head>
	<body>
		<Header></Header>
		<main class="flex flex-col items-center justify-evenly">
			<div class="text-center mb-10">
				<h1 class="text-5xl font-bold text-gray-800 my-5">Weight converter</h1>
			</div>
			<div class="flex gap-6 bg-gray-100 p-6 rounded-lg shadow-md">
				<form action="" method="POST" class="flex flex-col items-center w-xl">
					<label for="lengthInput" class="block text-gray-500 font-semibold mb-2 w-full">Value</label>
					<input type="number" id="lengthInput" name="lengthInput" class="w-full p-2 border border-gray-300 rounded mb-4" placeholder="Enter value" value=lengthInput />

					<div class="flex gap-4 mb-4 w-full">
						<div class="w-1/2">
							<label for="fromUnit" class="block text-gray-500 font-semibold mb-2">From</label>
							<select id="fromUnit" name="fromUnit" class="w-full p-2 border border-gray-300 rounded text-gray-500">
								<option value="kilogram">Kilograms</option>
								<option value="gram">Grams</option>
								<option value="milligram">Milligrams</option>
								<option value="pound">Pounds</option>
								<option value="ounce">Ounces</option>
							</select>
						</div>

						<div class="w-1/2">
							<label for="toUnit" class="block text-gray-500 font-semibold mb-2">To</label>
							<select id="toUnit" name="toUnit" class="w-full p-2 border border-gray-300 rounded mb-4 text-gray-500">
								<option value="kilogram">Kilograms</option>
								<option value="gram">Grams</option>
								<option value="milligram">Milligrams</option>
								<option value="pound">Pounds</option>
								<option value="ounce">Ounces</option>
							</select>
						</div>
					</div>

					<button type="submit" class="bg-blue-100 hover:bg-blue-200 py-2 px-4 rounded-4xl" >
						<img src="https://www.svgrepo.com/show/507867/switch-horizontal.svg" alt="" width="60px">
					</button>

					<label for="result" class="block text-gray-700 font-semibold mb-2 w-full mt-3">Result</label>
					<input type="number" id="result" name="result" class="w-full p-2 border border-gray-300 rounded mb-4 text-gray-700 font-semibold" value="5" disabled/>
				</form>
				
			</div>
		</main>
		
		<Footer></Footer>
	</body>
	<script>
		const form = document.querySelector<HTMLFormElement>('form');
		if (!form) {
			// Form not found in the DOM — stop early to satisfy TypeScript and avoid runtime errors
			throw new Error('Form element not found');
		}

		form.addEventListener('submit', (e) => {
			e.preventDefault();

			const lengthInputEl = document.getElementById('lengthInput') as HTMLInputElement | null;
			const fromUnitEl = document.getElementById('fromUnit') as HTMLSelectElement | null;
			const toUnitEl = document.getElementById('toUnit') as HTMLSelectElement | null;
			const resultEl = document.getElementById('result') as HTMLInputElement | null;

			if (!lengthInputEl || !fromUnitEl || !toUnitEl || !resultEl) {
			// Missing expected inputs — fail gracefully
			return;
			}

			const lengthInput = parseFloat(lengthInputEl.value);
			if (Number.isNaN(lengthInput)) {
			resultEl.value = 'Invalid';
			return;
			}

			const fromUnit = fromUnitEl.value;
			const toUnit = toUnitEl.value;

			const conversionRates: Record<string, number> = {
			kilogram: 1,
			gram: 0.001,
			milligram: 0.000001,
			pound: 0.453592,
			ounce: 0.0283495,
			};

			if (!(fromUnit in conversionRates) || !(toUnit in conversionRates)) {
			resultEl.value = 'Invalid unit';
			return;
			}

			const valueInMeters = lengthInput * conversionRates[fromUnit];
			const convertedValue = valueInMeters / conversionRates[toUnit];

			resultEl.value = Number.isFinite(convertedValue) ? convertedValue.toFixed(4) : 'Invalid';
		});
	</script>
</html>